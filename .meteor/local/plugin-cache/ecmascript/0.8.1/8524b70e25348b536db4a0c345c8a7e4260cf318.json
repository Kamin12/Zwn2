{"metadata":{"usedHelpers":[],"marked":[],"modules":{"imports":[{"source":"./set-scroll","imported":["default"],"specifiers":[{"kind":"named","imported":"default","local":"setScroll"}]}],"exports":{"exported":["event","template"],"specifiers":[{"kind":"local","local":"event","exported":"default"},{"kind":"local","local":"template","exported":"default"}]}}},"options":{"filename":"imports/ui/components/handle-message-insert.js","filenameRelative":"imports/ui/components/handle-message-insert.js","env":{"development":{"plugins":[]}},"retainLines":false,"highlightCode":true,"suppressDeprecationMessages":false,"presets":[],"plugins":[[[],{"generateLetDeclarations":true,"enforceStrictMode":false}],[[],null],[[],{"polyfill":false}],[[],null],[[],null],[[],null],[[],{"allowTopLevelThis":true,"strict":false,"loose":true}],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],{"loose":true}],[[],{"loose":true}],[[],null],[[],{"loose":true}],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],{"loose":true}],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null]],"ignore":[],"code":true,"metadata":true,"ast":true,"comments":true,"compact":false,"minified":false,"sourceMap":true,"sourceMaps":true,"sourceMapTarget":"imports/ui/components/handle-message-insert.js.map","sourceFileName":"imports/ui/components/handle-message-insert.js","babelrc":false,"sourceType":"module","moduleIds":false,"passPerPreset":false,"parserOpts":false,"generatorOpts":false,"basename":"handle-message-insert"},"ignored":false,"code":"var setScroll = void 0;\nmodule.watch(require(\"./set-scroll\"), {\n  \"default\": function (v) {\n    setScroll = v;\n  }\n}, 0);\n\nvar _getMessage = function (template) {\n  var message = template.find('[name=\"message\"]').value;\n  return message.trim();\n};\n\nvar _checkIfCanInsert = function (message, event) {\n  return message !== '' && event.keyCode === 13;\n};\n\nvar _buildMessage = function (template) {\n  return {\n    destination: FlowRouter.getParam('channel').replace('@', ''),\n    isDirect: template.isDirect.get(),\n    message: template.find('[name=\"message\"]').value\n  };\n};\n\nvar _handleInsert = function (message, event, template) {\n  Meteor.call('insertMessage', message, function (error) {\n    if (error) {\n      Bert.alert(error.reason, 'danger');\n    } else {\n      event.target.value = '';\n    }\n  });\n};\n\nmodule.exportDefault(function (event, template) {\n  var text = _getMessage(template),\n      canInsert = _checkIfCanInsert(text, event);\n\n  if (canInsert) {\n    setScroll('messages');\n\n    _handleInsert(_buildMessage(template), event, template);\n  }\n});","map":{"version":3,"sources":["imports/ui/components/handle-message-insert.js"],"names":["setScroll","module","watch","require","v","_getMessage","template","message","find","value","trim","_checkIfCanInsert","event","keyCode","_buildMessage","destination","FlowRouter","getParam","replace","isDirect","get","_handleInsert","Meteor","call","error","Bert","alert","reason","target","exportDefault","text","canInsert"],"mappings":"AAAA,IAAIA,kBAAJ;AAAcC,OAAOC,KAAP,CAAaC,QAAQ,cAAR,CAAb,EAAqC;AAAA,uBAASC,CAAT,EAAW;AAACJ,gBAAUI,CAAV;AAAY;AAAxB,CAArC,EAA+D,CAA/D;;AAEd,IAAIC,cAAc,UAAEC,QAAF,EAAgB;AAChC,MAAIC,UAAUD,SAASE,IAAT,CAAe,kBAAf,EAAoCC,KAAlD;AACA,SAAOF,QAAQG,IAAR,EAAP;AACD,CAHD;;AAKA,IAAIC,oBAAoB,UAAEJ,OAAF,EAAWK,KAAX,EAAsB;AAC5C,SAAOL,YAAY,EAAZ,IAAkBK,MAAMC,OAAN,KAAkB,EAA3C;AACD,CAFD;;AAIA,IAAIC,gBAAgB,UAAER,QAAF,EAAgB;AAClC,SAAO;AACLS,iBAAaC,WAAWC,QAAX,CAAqB,SAArB,EAAiCC,OAAjC,CAA0C,GAA1C,EAA+C,EAA/C,CADR;AAELC,cAAUb,SAASa,QAAT,CAAkBC,GAAlB,EAFL;AAGLb,aAASD,SAASE,IAAT,CAAe,kBAAf,EAAoCC;AAHxC,GAAP;AAKD,CAND;;AAQA,IAAIY,gBAAgB,UAAEd,OAAF,EAAWK,KAAX,EAAkBN,QAAlB,EAAgC;AAClDgB,SAAOC,IAAP,CAAa,eAAb,EAA8BhB,OAA9B,EAAuC,UAAEiB,KAAF,EAAa;AAClD,QAAKA,KAAL,EAAa;AACXC,WAAKC,KAAL,CAAYF,MAAMG,MAAlB,EAA0B,QAA1B;AACD,KAFD,MAEO;AACLf,YAAMgB,MAAN,CAAanB,KAAb,GAAqB,EAArB;AACD;AACF,GAND;AAOD,CARD;;AAnBAR,OAAO4B,aAAP,CA6Be,UAAUjB,KAAV,EAAiBN,QAAjB,EAA4B;AACzC,MAAIwB,OAAYzB,YAAaC,QAAb,CAAhB;AAAA,MACIyB,YAAYpB,kBAAmBmB,IAAnB,EAAyBlB,KAAzB,CADhB;;AAGA,MAAKmB,SAAL,EAAiB;AACf/B,cAAW,UAAX;;AACAqB,kBAAeP,cAAeR,QAAf,CAAf,EAA0CM,KAA1C,EAAiDN,QAAjD;AACD;AACF,CArCD","file":"imports/ui/components/handle-message-insert.js.map","sourcesContent":["import setScroll from './set-scroll';\n\nlet _getMessage = ( template ) => {\n  let message = template.find( '[name=\"message\"]' ).value;\n  return message.trim();\n};\n\nlet _checkIfCanInsert = ( message, event ) => {\n  return message !== '' && event.keyCode === 13;\n};\n\nlet _buildMessage = ( template ) => {\n  return {\n    destination: FlowRouter.getParam( 'channel' ).replace( '@', '' ),\n    isDirect: template.isDirect.get(),\n    message: template.find( '[name=\"message\"]' ).value\n  };\n};\n\nlet _handleInsert = ( message, event, template ) => {\n  Meteor.call( 'insertMessage', message, ( error ) => {\n    if ( error ) {\n      Bert.alert( error.reason, 'danger' );\n    } else {\n      event.target.value = '';\n    }\n  });\n};\n\nexport default function( event, template ) {\n  let text      = _getMessage( template ),\n      canInsert = _checkIfCanInsert( text, event );\n\n  if ( canInsert ) {\n    setScroll( 'messages' );\n    _handleInsert( _buildMessage( template ), event, template );\n  }\n}\n"]},"hash":"8524b70e25348b536db4a0c345c8a7e4260cf318"}
